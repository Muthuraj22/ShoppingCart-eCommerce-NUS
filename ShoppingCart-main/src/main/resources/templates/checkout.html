
<!--
Author: Muthu Raj, Sujitha
-->

<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <title>Checkout</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <link rel="stylesheet" th:href="@{/css/navbar.css}">
    <style>
        body {
            background-color: #f8f9fa;
            font-family: 'Segoe UI', sans-serif;
        }

        .checkout-card {
            max-width: 750px; /* increased width for better alignment */
            margin: 2rem auto;
            background-color: #ffffff;
            padding: 2rem;
            border-radius: 0.75rem;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }

        .checkout-table th, .checkout-table td {
            padding: 0.75rem;
            vertical-align: middle;
        }

        .btn-confirm {
            min-width: 180px;
        }

        a.back-link {
            text-decoration: none;
            color: #0d6efd;
        }

        a.back-link:hover {
            text-decoration: underline;
        }

        select.form-select {
            display: inline-block;
            width: 230px;
            margin-left: 0.5rem;
            border: solid #ced4da !important;
            box-shadow: none !important;
            background-color: #fff;
            height: 48px;
            font-weight: 500;
            padding-right: 2rem;
        }

        select.form-select:focus {
            border-color: #0d6efd;
            box-shadow: 0 0 5px rgba(13, 110, 253, 0.3);
        }

        .error-message {
            color: red;
            font-weight: bold;
            margin-bottom: 1rem;
        }
    </style>
</head>
<body>

<div th:replace="~{fragments/navbar :: navbar}"></div>

<div class="checkout-card">
    <h2 class="text-center mb-4">Checkout</h2>


    <div th:if="${checkoutError}" class="error-message text-center">
        Unable to complete the checkout. Please try again.
    </div>
    <div th:if="${cartEmpty}" class="text-center mb-3">
        Your cart is empty.
    </div>

    <div th:if="${cart != null and cart.cartItems != null and !#lists.isEmpty(cart.cartItems)}">
        <table class="table table-bordered checkout-table">
            <thead class="table-light">
            <tr>
                <th>Product</th>
                <th class="text-end">Quantity</th>
                <th class="text-end">Price</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="item : ${cart.cartItems}">
                <td th:text="${item.product.name}">Product</td>
                <td class="text-end" th:text="${item.quantity}">1</td>
                <td class="text-end"
                    th:text="'$ ' +${#numbers.formatDecimal(item.product.unitPrice * item.quantity, 1, 2)}">0.00
                </td>
            </tr>
            <tr>
                <td colspan="2" class="text-end fw-bold">Total:</td>
                <td class="text-end fw-bold" th:text="'$ ' +${#numbers.formatDecimal(orderTotal, 1, 2)}">0.00</td>
            </tr>
            </tbody>
        </table>
    </div>


    <form th:action="@{/orders/checkout}" method="post" class="text-center mt-4">
        <input type="hidden" name="cartId" th:value="${cartId}"/>

        <div class="d-flex justify-content-center align-items-center gap-3 flex-wrap">
            <label for="paymentMethod" class="fw-semibold mb-0">Payment Method:</label>

            <select id="paymentMethod" name="paymentMethod"
                    class="form-select"
                    style="width:225px; height:42px; font-weight:400; border:none; box-shadow:none;">
                <option value="CREDIT_CARD">Credit Card</option>
                <option value="CASH_ON_DELIVERY">Cash on Delivery</option>
                <option value="Paynow/NETs">PayNow</option>
            </select>

            <button type="submit"
                    class="btn btn-primary d-flex align-items-center justify-content-center gap-2"
                    style="width:180px; height:42px; font-weight:400;">
                <i class="bi bi-check-circle"></i> Confirm Order
            </button>
        </div>
    </form>


    <div class="text-center mt-4">
        <button type="button" class="btn btn-outline-secondary btn-continue"
                onclick="window.location.href='/cart'">
            <i class="bi bi-arrow-left"></i> Back to Cart
        </button>
    </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
